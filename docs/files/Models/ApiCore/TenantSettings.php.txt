<?php
/**
 * cloudonix-php - A PHP Class for interfacing with the Cloudonix API.Core Interface
 *
 * Cloudonix API.Core provides its users with a programmable API to manage and control their Cloudonix platform
 * account, domains, applications, trunks, DNIDs, subscribers and more. The class library provides its entire
 * functionality via models, located under the /src/Models/ApiCore/ directory.
 *
 * @author: Nir Simionovich
 * @license: LGPL 3.0 (https://www.gnu.org/licenses/lgpl-3.0.en.html)
 * @copyright: Cloudonix, Inc. May 2019. All Rights Reserved.
 * @site: https://cloudonix.io
 */

namespace Cloudonix\ApiCore;

/**
 * Cloudonix Api.Core TenantSettings Data Model API
 *
 * Class TenantSettings
 * @package Cloudonix\ApiCore
 */
class TenantSettings
{
	/** @var ApiCoreClient $apiClientConnector    	The previously initiated ApiCoreClient object */
	public $apiClientConnector = null;

	/** @var integer $tenantId The tenant ID initiating the API, for system privilage - null */
	public $tenantId = null;

	/**
	 * TenantSettings constructor.
	 * @param object $connector    This is the Cloudonix Client Connector Object (\GuzzleHttp\Client)
	 */
	public function __construct($connector = null)
	{
		try {

			if ($connector == null) {
				throw new \Exception("Input values can not be null");
			}

			$this->apiClientConnector = $connector->apiClientConnector;
			$this->tenantId = $connector->tenantId;

		} catch (\Exception $e) {
			die("Exception Raised at " . $e->getFile() . " Line: " . $e->getLine() . " Message: [" . $e->getMessage() . "]");
		}
	}

	/**
	 * TenantSettings destructor.
	 */
	public function __destruct()
	{
		// TODO: Implement __destruct() method.
	}

	/**
	 * Get Cloudonix Tenant Settings
	 *
	 * @param integer $id          The Cloudonix Tenant ID
	 * @param string $setting      The Setting keyword in the Tenant profile to get
	 * @return mixed               A JSON object containing the remote Cloudonix response
	 */
	public function get($id = null, $setting = null)
	{
		try {

			if ($this->apiClientConnector == null) {
				throw new \Exception("Cloudonix Client had not been initialised properly");
			}

			if ($id == null) {
				throw new \Exception("Tenant ID can not be null");
			}

			$request_result = $this->apiClientConnector->request('GET', '/tenants/' . $id . "/settings/" . $setting);

			return json_decode($request_result->getBody());

		} catch (\Exception $e) {
			die("Exception Raised at " . $e->getFile() . " Line: " . $e->getLine() . " Message: [" . $e->getMessage() . "]");
		}
	}

	/**
	 * Delete A Tenant's Settings
	 *
	 * @param integer $id          The Cloudonix Tenant ID
	 * @param string $setting      The Setting keyword in the Tenant profile to delete
	 * @return mixed               A JSON object containing the remote Cloudonix response
	 */
	public function delete($id = null, $setting = null)
	{
		try {

			if ($this->apiClientConnector == null) {
				throw new \Exception("Cloudonix Client had not been initialised properly");
			}

			if (($id == null) || ($setting == null)) {
				throw new \Exception("Tenant ID/setting can not be null");
			}

			$request_result = $this->apiClientConnector->request('DELETE', '/tenants/' . $id . "/settings/" . $setting);

			return json_decode($request_result->getBody());

		} catch (\Exception $e) {
			die("Exception Raised at " . $e->getFile() . " Line: " . $e->getLine() . " Message: [" . $e->getMessage() . "]");
		}
	}

	/**
	 * Update a Tenant's Settings
	 *
	 * @param integer $id          The Cloudonix Tenant ID
	 * @param string $setting      The setting keyword in the tenant profile to update
	 * @param string $value        The value to assign to the setting, designated by $setting
	 * @return mixed               A JSON object containing the remote Cloudonix response
	 */
	public function patch($id = null, $setting = null, $value = null)
	{
		try {

			if ($this->apiClientConnector == null) {
				throw new \Exception("Cloudonix Client had not been initialised properly");
			}

			if (($id == null) || ($setting == null) || ($value == null)) {
				throw new \Exception("Tenant ID/setting/value can not be null");
			}

			$input = [
				"value" => $value
			];

			$request_result = $this->apiClientConnector->request('PUT', '/tenants/' . $id . "/settings/" . $setting, ['json' => $input]);

			return json_decode($request_result->getBody());

		} catch (\Exception $e) {
			die("Exception Raised at " . $e->getFile() . " Line: " . $e->getLine() . " Message: [" . $e->getMessage() . "]");
		}
	}
}

